"use strict";(self.webpackChunknote_star_cn=self.webpackChunknote_star_cn||[]).push([[4272],{43022:function(e,t,s){s.d(t,{j5:function(){return I}});var a=s(2824);const l=Symbol("uploadContextKey");var o=s(91361),n=s(48548),i=s(79555),r=s(97859),u=s(41651),c=s(90033);class d extends Error{constructor(e,t,s,a){super(e),this.name="UploadAjaxError",this.status=t,this.method=s,this.url=a}}function p(e,t,s){let a;return a=s.response?`${s.response.error||s.response}`:s.responseText?`${s.responseText}`:`fail to ${t.method} ${e} ${s.status}`,new d(a,s.status,t.method,e)}var f=s(50819),v=s(51254);const y=["text","picture","picture-card"];let R=1;const m=()=>Date.now()+R++,g=(0,f.b_)({action:{type:String,default:"#"},headers:{type:(0,f.jq)(Object)},method:{type:String,default:"post"},data:{type:(0,f.jq)([Object,Function,Promise]),default:()=>(0,v.f)({})},multiple:Boolean,name:{type:String,default:"file"},drag:Boolean,withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:(0,f.jq)(Array),default:()=>(0,v.f)([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:y,default:"text"},httpRequest:{type:(0,f.jq)(Function),default:e=>{"undefined"==typeof XMLHttpRequest&&(0,u.$)("ElUpload","XMLHttpRequest is undefined");const t=new XMLHttpRequest,s=e.action;t.upload&&t.upload.addEventListener("progress",(t=>{const s=t;s.percent=t.total>0?t.loaded/t.total*100:0,e.onProgress(s)}));const a=new FormData;if(e.data)for(const[t,s]of Object.entries(e.data))(0,c.cy)(s)&&s.length?a.append(t,...s):a.append(t,s);a.append(e.filename,e.file,e.file.name),t.addEventListener("error",(()=>{e.onError(p(s,e,t))})),t.addEventListener("load",(()=>{if(t.status<200||t.status>=300)return e.onError(p(s,e,t));e.onSuccess(function(e){const t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch(e){return t}}(t))})),t.open(e.method,s,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);const l=e.headers||{};if(l instanceof Headers)l.forEach(((e,s)=>t.setRequestHeader(s,e)));else for(const[e,s]of Object.entries(l))(0,r.A)(s)||t.setRequestHeader(e,String(s));return t.send(a),t}},disabled:Boolean,limit:Number}),b=(0,f.b_)({...g,beforeUpload:{type:(0,f.jq)(Function),default:c.tE},beforeRemove:{type:(0,f.jq)(Function)},onRemove:{type:(0,f.jq)(Function),default:c.tE},onChange:{type:(0,f.jq)(Function),default:c.tE},onPreview:{type:(0,f.jq)(Function),default:c.tE},onSuccess:{type:(0,f.jq)(Function),default:c.tE},onProgress:{type:(0,f.jq)(Function),default:c.tE},onError:{type:(0,f.jq)(Function),default:c.tE},onExceed:{type:(0,f.jq)(Function),default:c.tE},crossorigin:{type:(0,f.jq)(String)}}),h=(0,f.b_)({files:{type:(0,f.jq)(Array),default:()=>(0,v.f)([])},disabled:{type:Boolean,default:!1},handlePreview:{type:(0,f.jq)(Function),default:c.tE},listType:{type:String,values:y,default:"text"},crossorigin:{type:(0,f.jq)(String)}});var k=s(78396),C=s(87404),E=s(65980),F=s(99510);const w=(0,a.pM)({name:"ElUploadList"}),j=(0,a.pM)({...w,props:h,emits:{remove:e=>!!e},setup(e,{emit:t}){const s=e,{t:l}=(0,C.Ym)(),r=(0,E.DU)("upload"),u=(0,E.DU)("icon"),c=(0,E.DU)("list"),d=(0,F.CB)(),p=(0,a.KR)(!1),f=(0,a.EW)((()=>[r.b("list"),r.bm("list",s.listType),r.is("disabled",s.disabled)])),v=e=>{t("remove",e)};return(e,t)=>((0,a.uX)(),(0,a.Wv)(a.F,{tag:"ul",class:(0,a.C4)((0,a.R1)(f)),name:(0,a.R1)(c).b()},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.files,((t,s)=>((0,a.uX)(),(0,a.CE)("li",{key:t.uid||t.name,class:(0,a.C4)([(0,a.R1)(r).be("list","item"),(0,a.R1)(r).is(t.status),{focusing:p.value}]),tabindex:"0",onKeydown:(0,a.jR)((e=>!(0,a.R1)(d)&&v(t)),["delete"]),onFocus:e=>p.value=!0,onBlur:e=>p.value=!1,onClick:e=>p.value=!1},[(0,a.RG)(e.$slots,"default",{file:t,index:s},(()=>["picture"===e.listType||"uploading"!==t.status&&"picture-card"===e.listType?((0,a.uX)(),(0,a.CE)("img",{key:0,class:(0,a.C4)((0,a.R1)(r).be("list","item-thumbnail")),src:t.url,crossorigin:e.crossorigin,alt:""},null,10,["src","crossorigin"])):(0,a.Q3)("v-if",!0),"uploading"===t.status||"picture-card"!==e.listType?((0,a.uX)(),(0,a.CE)("div",{key:1,class:(0,a.C4)((0,a.R1)(r).be("list","item-info"))},[(0,a.Lk)("a",{class:(0,a.C4)((0,a.R1)(r).be("list","item-name")),onClick:(0,a.D$)((s=>e.handlePreview(t)),["prevent"])},[(0,a.bF)((0,a.R1)(o.tk),{class:(0,a.C4)((0,a.R1)(u).m("document"))},{default:(0,a.k6)((()=>[(0,a.bF)((0,a.R1)(n.yoT))])),_:1},8,["class"]),(0,a.Lk)("span",{class:(0,a.C4)((0,a.R1)(r).be("list","item-file-name")),title:t.name},(0,a.v_)(t.name),11,["title"])],10,["onClick"]),"uploading"===t.status?((0,a.uX)(),(0,a.Wv)((0,a.R1)(i.ve),{key:0,type:"picture-card"===e.listType?"circle":"line","stroke-width":"picture-card"===e.listType?6:2,percentage:Number(t.percentage),style:(0,a.Tr)("picture-card"===e.listType?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):(0,a.Q3)("v-if",!0)],2)):(0,a.Q3)("v-if",!0),(0,a.Lk)("label",{class:(0,a.C4)((0,a.R1)(r).be("list","item-status-label"))},["text"===e.listType?((0,a.uX)(),(0,a.Wv)((0,a.R1)(o.tk),{key:0,class:(0,a.C4)([(0,a.R1)(u).m("upload-success"),(0,a.R1)(u).m("circle-check")])},{default:(0,a.k6)((()=>[(0,a.bF)((0,a.R1)(n.rW7))])),_:1},8,["class"])):["picture-card","picture"].includes(e.listType)?((0,a.uX)(),(0,a.Wv)((0,a.R1)(o.tk),{key:1,class:(0,a.C4)([(0,a.R1)(u).m("upload-success"),(0,a.R1)(u).m("check")])},{default:(0,a.k6)((()=>[(0,a.bF)((0,a.R1)(n.Jlk))])),_:1},8,["class"])):(0,a.Q3)("v-if",!0)],2),(0,a.R1)(d)?(0,a.Q3)("v-if",!0):((0,a.uX)(),(0,a.Wv)((0,a.R1)(o.tk),{key:2,class:(0,a.C4)((0,a.R1)(u).m("close")),onClick:e=>v(t)},{default:(0,a.k6)((()=>[(0,a.bF)((0,a.R1)(n.bm))])),_:2},1032,["class","onClick"])),(0,a.Q3)(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),(0,a.Q3)(" This is a bug which needs to be fixed "),(0,a.Q3)(" TODO: Fix the incorrect navigation interaction "),(0,a.R1)(d)?(0,a.Q3)("v-if",!0):((0,a.uX)(),(0,a.CE)("i",{key:3,class:(0,a.C4)((0,a.R1)(u).m("close-tip"))},(0,a.v_)((0,a.R1)(l)("el.upload.deleteTip")),3)),"picture-card"===e.listType?((0,a.uX)(),(0,a.CE)("span",{key:4,class:(0,a.C4)((0,a.R1)(r).be("list","item-actions"))},[(0,a.Lk)("span",{class:(0,a.C4)((0,a.R1)(r).be("list","item-preview")),onClick:s=>e.handlePreview(t)},[(0,a.bF)((0,a.R1)(o.tk),{class:(0,a.C4)((0,a.R1)(u).m("zoom-in"))},{default:(0,a.k6)((()=>[(0,a.bF)((0,a.R1)(n.$Zd))])),_:1},8,["class"])],10,["onClick"]),(0,a.R1)(d)?(0,a.Q3)("v-if",!0):((0,a.uX)(),(0,a.CE)("span",{key:0,class:(0,a.C4)((0,a.R1)(r).be("list","item-delete")),onClick:e=>v(t)},[(0,a.bF)((0,a.R1)(o.tk),{class:(0,a.C4)((0,a.R1)(u).m("delete"))},{default:(0,a.k6)((()=>[(0,a.bF)((0,a.R1)(n.epd))])),_:1},8,["class"])],10,["onClick"]))],2)):(0,a.Q3)("v-if",!0)]))],42,["onKeydown","onFocus","onBlur","onClick"])))),128)),(0,a.RG)(e.$slots,"append")])),_:3},8,["class","name"]))}});var $=(0,k.A)(j,[["__file","upload-list.vue"]]),_=s(20903),q=s(46996);const L=(0,f.b_)({disabled:{type:Boolean,default:!1}}),T={file:e=>(0,c.cy)(e)},S="ElUploadDrag",U=(0,a.pM)({name:S}),x=(0,a.pM)({...U,props:L,emits:T,setup(e,{emit:t}){(0,a.WQ)(l)||(0,u.$)(S,"usage: <el-upload><el-upload-dragger /></el-upload>");const s=(0,E.DU)("upload"),o=(0,a.KR)(!1),n=(0,F.CB)(),i=e=>{if(n.value)return;o.value=!1,e.stopPropagation();const s=Array.from(e.dataTransfer.files);t("file",s)},r=()=>{n.value||(o.value=!0)};return(e,t)=>((0,a.uX)(),(0,a.CE)("div",{class:(0,a.C4)([(0,a.R1)(s).b("dragger"),(0,a.R1)(s).is("dragover",o.value)]),onDrop:(0,a.D$)(i,["prevent"]),onDragover:(0,a.D$)(r,["prevent"]),onDragleave:(0,a.D$)((e=>o.value=!1),["prevent"])},[(0,a.RG)(e.$slots,"default")],42,["onDrop","onDragover","onDragleave"]))}});var X=(0,k.A)(x,[["__file","upload-dragger.vue"]]);const D=(0,f.b_)({...g,beforeUpload:{type:(0,f.jq)(Function),default:c.tE},onRemove:{type:(0,f.jq)(Function),default:c.tE},onStart:{type:(0,f.jq)(Function),default:c.tE},onSuccess:{type:(0,f.jq)(Function),default:c.tE},onProgress:{type:(0,f.jq)(Function),default:c.tE},onError:{type:(0,f.jq)(Function),default:c.tE},onExceed:{type:(0,f.jq)(Function),default:c.tE}});var Q=s(61649);const P=(0,a.pM)({name:"ElUploadContent",inheritAttrs:!1}),B=(0,a.pM)({...P,props:D,setup(e,{expose:t}){const s=e,l=(0,E.DU)("upload"),o=(0,F.CB)(),n=(0,a.IJ)({}),i=(0,a.IJ)(),r=e=>{if(0===e.length)return;const{autoUpload:t,limit:a,fileList:l,multiple:o,onStart:n,onExceed:i}=s;if(a&&l.length+e.length>a)i(e,l);else{o||(e=e.slice(0,1));for(const s of e){const e=s;e.uid=m(),n(e),t&&u(e)}}},u=async e=>{if(i.value.value="",!s.beforeUpload)return d(e);let t,a={};try{const l=s.data,o=s.beforeUpload(e);a=(0,c.Qd)(s.data)?(0,_.A)(s.data):s.data,t=await o,(0,c.Qd)(s.data)&&(0,q.A)(l,a)&&(a=(0,_.A)(s.data))}catch(e){t=!1}if(!1===t)return void s.onRemove(e);let l=e;t instanceof Blob&&(l=t instanceof File?t:new File([t],e.name,{type:e.type})),d(Object.assign(l,{uid:e.uid}),a)},d=async(e,t)=>{const{headers:a,data:l,method:o,withCredentials:i,name:r,action:u,onProgress:d,onSuccess:p,onError:f,httpRequest:v}=s;try{t=await(async(e,t)=>(0,c.Tn)(e)?e(t):e)(null!=t?t:l,e)}catch(t){return void s.onRemove(e)}const{uid:y}=e,R={headers:a||{},withCredentials:i,file:e,data:t,method:o,filename:r,action:u,onProgress:t=>{d(t,e)},onSuccess:t=>{p(t,e),delete n.value[y]},onError:t=>{f(t,e),delete n.value[y]}},m=v(R);n.value[y]=m,m instanceof Promise&&m.then(R.onSuccess,R.onError)},p=e=>{const t=e.target.files;t&&r(Array.from(t))},f=()=>{o.value||(i.value.value="",i.value.click())},v=()=>{f()};return t({abort:e=>{(0,Q.Mc)(n.value).filter(e?([t])=>String(e.uid)===t:()=>!0).forEach((([e,t])=>{t instanceof XMLHttpRequest&&t.abort(),delete n.value[e]}))},upload:u}),(e,t)=>((0,a.uX)(),(0,a.CE)("div",{class:(0,a.C4)([(0,a.R1)(l).b(),(0,a.R1)(l).m(e.listType),(0,a.R1)(l).is("drag",e.drag),(0,a.R1)(l).is("disabled",(0,a.R1)(o))]),tabindex:(0,a.R1)(o)?"-1":"0",onClick:f,onKeydown:(0,a.jR)((0,a.D$)(v,["self"]),["enter","space"])},[e.drag?((0,a.uX)(),(0,a.Wv)(X,{key:0,disabled:(0,a.R1)(o),onFile:r},{default:(0,a.k6)((()=>[(0,a.RG)(e.$slots,"default")])),_:3},8,["disabled"])):(0,a.RG)(e.$slots,"default",{key:1}),(0,a.Lk)("input",{ref_key:"inputRef",ref:i,class:(0,a.C4)((0,a.R1)(l).e("input")),name:e.name,disabled:(0,a.R1)(o),multiple:e.multiple,accept:e.accept,type:"file",onChange:p,onClick:(0,a.D$)((()=>{}),["stop"])},null,42,["name","disabled","multiple","accept","onClick"])],42,["tabindex","onKeydown"]))}});var W=(0,k.A)(B,[["__file","upload-content.vue"]]),A=s(97786);const G="ElUpload",M=e=>{var t;(null==(t=e.url)?void 0:t.startsWith("blob:"))&&URL.revokeObjectURL(e.url)},O=(e,t)=>{const s=(0,A.hRP)(e,"fileList",void 0,{passive:!0}),l=e=>s.value.find((t=>t.uid===e.uid));function o(e){var s;null==(s=t.value)||s.abort(e)}function n(e){s.value=s.value.filter((t=>t.uid!==e.uid))}return(0,a.wB)((()=>e.listType),(t=>{"picture-card"!==t&&"picture"!==t||(s.value=s.value.map((t=>{const{raw:a,url:l}=t;if(!l&&a)try{t.url=URL.createObjectURL(a)}catch(a){e.onError(a,t,s.value)}return t})))})),(0,a.wB)(s,(e=>{for(const t of e)t.uid||(t.uid=m()),t.status||(t.status="success")}),{immediate:!0,deep:!0}),{uploadFiles:s,abort:o,clearFiles:function(e=["ready","uploading","success","fail"]){s.value=s.value.filter((t=>!e.includes(t.status)))},handleError:(t,a)=>{const o=l(a);o&&(console.error(t),o.status="fail",n(o),e.onError(t,o,s.value),e.onChange(o,s.value))},handleProgress:(t,a)=>{const o=l(a);o&&(e.onProgress(t,o,s.value),o.status="uploading",o.percentage=Math.round(t.percent))},handleStart:t=>{(0,r.A)(t.uid)&&(t.uid=m());const a={name:t.name,percentage:0,status:"ready",size:t.size,raw:t,uid:t.uid};if("picture-card"===e.listType||"picture"===e.listType)try{a.url=URL.createObjectURL(t)}catch(t){(0,u.U)(G,t.message),e.onError(t,a,s.value)}s.value=[...s.value,a],e.onChange(a,s.value)},handleSuccess:(t,a)=>{const o=l(a);o&&(o.status="success",o.response=t,e.onSuccess(t,o,s.value),e.onChange(o,s.value))},handleRemove:async t=>{const a=t instanceof File?l(t):t;a||(0,u.$)(G,"file to be removed not found");const i=t=>{o(t),n(t),e.onRemove(t,s.value),M(t)};if(e.beforeRemove){!1!==await e.beforeRemove(a,s.value)&&i(a)}else i(a)},submit:function(){s.value.filter((({status:e})=>"ready"===e)).forEach((({raw:e})=>{var s;return e&&(null==(s=t.value)?void 0:s.upload(e))}))},revokeFileObjectURL:M}},K=(0,a.pM)({name:"ElUpload"}),H=(0,a.pM)({...K,props:b,setup(e,{expose:t}){const s=e,o=(0,F.CB)(),n=(0,a.IJ)(),{abort:i,submit:r,clearFiles:u,uploadFiles:c,handleStart:d,handleError:p,handleRemove:f,handleSuccess:v,handleProgress:y,revokeFileObjectURL:R}=O(s,n),m=(0,a.EW)((()=>"picture-card"===s.listType)),g=(0,a.EW)((()=>({...s,fileList:c.value,onStart:d,onProgress:y,onSuccess:v,onError:p,onRemove:f})));return(0,a.xo)((()=>{c.value.forEach(R)})),(0,a.Gt)(l,{accept:(0,a.lW)(s,"accept")}),t({abort:i,submit:r,clearFiles:u,handleStart:d,handleRemove:f}),(e,t)=>((0,a.uX)(),(0,a.CE)("div",null,[(0,a.R1)(m)&&e.showFileList?((0,a.uX)(),(0,a.Wv)($,{key:0,disabled:(0,a.R1)(o),"list-type":e.listType,files:(0,a.R1)(c),crossorigin:e.crossorigin,"handle-preview":e.onPreview,onRemove:(0,a.R1)(f)},(0,a.eX)({append:(0,a.k6)((()=>[(0,a.bF)(W,(0,a.v6)({ref_key:"uploadRef",ref:n},(0,a.R1)(g)),{default:(0,a.k6)((()=>[e.$slots.trigger?(0,a.RG)(e.$slots,"trigger",{key:0}):(0,a.Q3)("v-if",!0),!e.$slots.trigger&&e.$slots.default?(0,a.RG)(e.$slots,"default",{key:1}):(0,a.Q3)("v-if",!0)])),_:3},16)])),_:2},[e.$slots.file?{name:"default",fn:(0,a.k6)((({file:t,index:s})=>[(0,a.RG)(e.$slots,"file",{file:t,index:s})]))}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):(0,a.Q3)("v-if",!0),!(0,a.R1)(m)||(0,a.R1)(m)&&!e.showFileList?((0,a.uX)(),(0,a.Wv)(W,(0,a.v6)({key:1,ref_key:"uploadRef",ref:n},(0,a.R1)(g)),{default:(0,a.k6)((()=>[e.$slots.trigger?(0,a.RG)(e.$slots,"trigger",{key:0}):(0,a.Q3)("v-if",!0),!e.$slots.trigger&&e.$slots.default?(0,a.RG)(e.$slots,"default",{key:1}):(0,a.Q3)("v-if",!0)])),_:3},16)):(0,a.Q3)("v-if",!0),e.$slots.trigger?(0,a.RG)(e.$slots,"default",{key:2}):(0,a.Q3)("v-if",!0),(0,a.RG)(e.$slots,"tip"),!(0,a.R1)(m)&&e.showFileList?((0,a.uX)(),(0,a.Wv)($,{key:3,disabled:(0,a.R1)(o),"list-type":e.listType,files:(0,a.R1)(c),crossorigin:e.crossorigin,"handle-preview":e.onPreview,onRemove:(0,a.R1)(f)},(0,a.eX)({_:2},[e.$slots.file?{name:"default",fn:(0,a.k6)((({file:t,index:s})=>[(0,a.RG)(e.$slots,"file",{file:t,index:s})]))}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):(0,a.Q3)("v-if",!0)]))}});var J=(0,k.A)(H,[["__file","upload.vue"]]);const I=(0,s(64769).GU)(J)}}]);