"use strict";(self.webpackChunknote_star_cn=self.webpackChunknote_star_cn||[]).push([[4272],{47358:function(e,t,o){o.d(t,{j5:function(){return J}});o(18111),o(7588);var n=o(99601);const r=Symbol("uploadContextKey");var a=o(813),l=o(57477),s=o(69655),i=o(16032),c=o(86894),u=o(24232);class d extends Error{constructor(e,t,o,n){super(e),this.name="UploadAjaxError",this.status=t,this.method=o,this.url=n}}function f(e,t,o){let n;return n=o.response?`${o.response.error||o.response}`:o.responseText?`${o.responseText}`:`fail to ${t.method} ${e} ${o.status}`,new d(n,o.status,t.method,e)}var p=o(47378),m=o(76769);const v=["text","picture","picture-card"];let y=1;const h=()=>Date.now()+y++,g=(0,p.b_)({action:{type:String,default:"#"},headers:{type:(0,p.jq)(Object)},method:{type:String,default:"post"},data:{type:(0,p.jq)([Object,Function,Promise]),default:()=>(0,m.f)({})},multiple:Boolean,name:{type:String,default:"file"},drag:Boolean,withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:(0,p.jq)(Array),default:()=>(0,m.f)([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:v,default:"text"},httpRequest:{type:(0,p.jq)(Function),default:e=>{"undefined"==typeof XMLHttpRequest&&(0,c.$)("ElUpload","XMLHttpRequest is undefined");const t=new XMLHttpRequest,o=e.action;t.upload&&t.upload.addEventListener("progress",(t=>{const o=t;o.percent=t.total>0?t.loaded/t.total*100:0,e.onProgress(o)}));const n=new FormData;if(e.data)for(const[t,o]of Object.entries(e.data))(0,u.isArray)(o)&&o.length?n.append(t,...o):n.append(t,o);n.append(e.filename,e.file,e.file.name),t.addEventListener("error",(()=>{e.onError(f(o,e,t))})),t.addEventListener("load",(()=>{if(t.status<200||t.status>=300)return e.onError(f(o,e,t));e.onSuccess(function(e){const t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch(e){return t}}(t))})),t.open(e.method,o,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);const r=e.headers||{};if(r instanceof Headers)r.forEach(((e,o)=>t.setRequestHeader(o,e)));else for(const[e,o]of Object.entries(r))(0,i.A)(o)||t.setRequestHeader(e,String(o));return t.send(n),t}},disabled:Boolean,limit:Number}),k=(0,p.b_)({...g,beforeUpload:{type:(0,p.jq)(Function),default:u.NOOP},beforeRemove:{type:(0,p.jq)(Function)},onRemove:{type:(0,p.jq)(Function),default:u.NOOP},onChange:{type:(0,p.jq)(Function),default:u.NOOP},onPreview:{type:(0,p.jq)(Function),default:u.NOOP},onSuccess:{type:(0,p.jq)(Function),default:u.NOOP},onProgress:{type:(0,p.jq)(Function),default:u.NOOP},onError:{type:(0,p.jq)(Function),default:u.NOOP},onExceed:{type:(0,p.jq)(Function),default:u.NOOP},crossorigin:{type:(0,p.jq)(String)}}),C=(0,p.b_)({files:{type:(0,p.jq)(Array),default:()=>(0,m.f)([])},disabled:{type:Boolean,default:!1},handlePreview:{type:(0,p.jq)(Function),default:u.NOOP},listType:{type:String,values:v,default:"text"},crossorigin:{type:(0,p.jq)(String)}});var b=o(99077),w=o(36268),B=o(93513),N=o(37207);const O=(0,n.defineComponent)({name:"ElUploadList"}),E=(0,n.defineComponent)({...O,props:C,emits:{remove:e=>!!e},setup(e,{emit:t}){const o=e,{t:r}=(0,w.Ym)(),i=(0,B.DU)("upload"),c=(0,B.DU)("icon"),u=(0,B.DU)("list"),d=(0,N.CB)(),f=(0,n.ref)(!1),p=(0,n.computed)((()=>[i.b("list"),i.bm("list",o.listType),i.is("disabled",o.disabled)])),m=e=>{t("remove",e)};return(e,t)=>((0,n.openBlock)(),(0,n.createBlock)(n.TransitionGroup,{tag:"ul",class:(0,n.normalizeClass)((0,n.unref)(p)),name:(0,n.unref)(u).b()},{default:(0,n.withCtx)((()=>[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.files,((t,o)=>((0,n.openBlock)(),(0,n.createElementBlock)("li",{key:t.uid||t.name,class:(0,n.normalizeClass)([(0,n.unref)(i).be("list","item"),(0,n.unref)(i).is(t.status),{focusing:f.value}]),tabindex:"0",onKeydown:(0,n.withKeys)((e=>!(0,n.unref)(d)&&m(t)),["delete"]),onFocus:e=>f.value=!0,onBlur:e=>f.value=!1,onClick:e=>f.value=!1},[(0,n.renderSlot)(e.$slots,"default",{file:t,index:o},(()=>["picture"===e.listType||"uploading"!==t.status&&"picture-card"===e.listType?((0,n.openBlock)(),(0,n.createElementBlock)("img",{key:0,class:(0,n.normalizeClass)((0,n.unref)(i).be("list","item-thumbnail")),src:t.url,crossorigin:e.crossorigin,alt:""},null,10,["src","crossorigin"])):(0,n.createCommentVNode)("v-if",!0),"uploading"===t.status||"picture-card"!==e.listType?((0,n.openBlock)(),(0,n.createElementBlock)("div",{key:1,class:(0,n.normalizeClass)((0,n.unref)(i).be("list","item-info"))},[(0,n.createElementVNode)("a",{class:(0,n.normalizeClass)((0,n.unref)(i).be("list","item-name")),onClick:(0,n.withModifiers)((o=>e.handlePreview(t)),["prevent"])},[(0,n.createVNode)((0,n.unref)(a.tk),{class:(0,n.normalizeClass)((0,n.unref)(c).m("document"))},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(l.yoT))])),_:1},8,["class"]),(0,n.createElementVNode)("span",{class:(0,n.normalizeClass)((0,n.unref)(i).be("list","item-file-name")),title:t.name},(0,n.toDisplayString)(t.name),11,["title"])],10,["onClick"]),"uploading"===t.status?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(s.ve),{key:0,type:"picture-card"===e.listType?"circle":"line","stroke-width":"picture-card"===e.listType?6:2,percentage:Number(t.percentage),style:(0,n.normalizeStyle)("picture-card"===e.listType?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):(0,n.createCommentVNode)("v-if",!0)],2)):(0,n.createCommentVNode)("v-if",!0),(0,n.createElementVNode)("label",{class:(0,n.normalizeClass)((0,n.unref)(i).be("list","item-status-label"))},["text"===e.listType?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(a.tk),{key:0,class:(0,n.normalizeClass)([(0,n.unref)(c).m("upload-success"),(0,n.unref)(c).m("circle-check")])},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(l.rW7))])),_:1},8,["class"])):["picture-card","picture"].includes(e.listType)?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(a.tk),{key:1,class:(0,n.normalizeClass)([(0,n.unref)(c).m("upload-success"),(0,n.unref)(c).m("check")])},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(l.Jlk))])),_:1},8,["class"])):(0,n.createCommentVNode)("v-if",!0)],2),(0,n.unref)(d)?(0,n.createCommentVNode)("v-if",!0):((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(a.tk),{key:2,class:(0,n.normalizeClass)((0,n.unref)(c).m("close")),onClick:e=>m(t)},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(l.bm))])),_:2},1032,["class","onClick"])),(0,n.createCommentVNode)(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),(0,n.createCommentVNode)(" This is a bug which needs to be fixed "),(0,n.createCommentVNode)(" TODO: Fix the incorrect navigation interaction "),(0,n.unref)(d)?(0,n.createCommentVNode)("v-if",!0):((0,n.openBlock)(),(0,n.createElementBlock)("i",{key:3,class:(0,n.normalizeClass)((0,n.unref)(c).m("close-tip"))},(0,n.toDisplayString)((0,n.unref)(r)("el.upload.deleteTip")),3)),"picture-card"===e.listType?((0,n.openBlock)(),(0,n.createElementBlock)("span",{key:4,class:(0,n.normalizeClass)((0,n.unref)(i).be("list","item-actions"))},[(0,n.createElementVNode)("span",{class:(0,n.normalizeClass)((0,n.unref)(i).be("list","item-preview")),onClick:o=>e.handlePreview(t)},[(0,n.createVNode)((0,n.unref)(a.tk),{class:(0,n.normalizeClass)((0,n.unref)(c).m("zoom-in"))},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(l.$Zd))])),_:1},8,["class"])],10,["onClick"]),(0,n.unref)(d)?(0,n.createCommentVNode)("v-if",!0):((0,n.openBlock)(),(0,n.createElementBlock)("span",{key:0,class:(0,n.normalizeClass)((0,n.unref)(i).be("list","item-delete")),onClick:e=>m(t)},[(0,n.createVNode)((0,n.unref)(a.tk),{class:(0,n.normalizeClass)((0,n.unref)(c).m("delete"))},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(l.epd))])),_:1},8,["class"])],10,["onClick"]))],2)):(0,n.createCommentVNode)("v-if",!0)]))],42,["onKeydown","onFocus","onBlur","onClick"])))),128)),(0,n.renderSlot)(e.$slots,"append")])),_:3},8,["class","name"]))}});var S=(0,b.A)(E,[["__file","upload-list.vue"]]),F=(o(22489),o(35856)),R=o(39195);const j=(0,p.b_)({disabled:{type:Boolean,default:!1}}),P={file:e=>(0,u.isArray)(e)},x="ElUploadDrag",V=(0,n.defineComponent)({name:x}),q=(0,n.defineComponent)({...V,props:j,emits:P,setup(e,{emit:t}){(0,n.inject)(r)||(0,c.$)(x,"usage: <el-upload><el-upload-dragger /></el-upload>");const o=(0,B.DU)("upload"),a=(0,n.ref)(!1),l=(0,N.CB)(),s=e=>{if(l.value)return;a.value=!1,e.stopPropagation();const o=Array.from(e.dataTransfer.files);t("file",o)},i=()=>{l.value||(a.value=!0)};return(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)([(0,n.unref)(o).b("dragger"),(0,n.unref)(o).is("dragover",a.value)]),onDrop:(0,n.withModifiers)(s,["prevent"]),onDragover:(0,n.withModifiers)(i,["prevent"]),onDragleave:(0,n.withModifiers)((e=>a.value=!1),["prevent"])},[(0,n.renderSlot)(e.$slots,"default")],42,["onDrop","onDragover","onDragleave"]))}});var _=(0,b.A)(q,[["__file","upload-dragger.vue"]]);const $=(0,p.b_)({...g,beforeUpload:{type:(0,p.jq)(Function),default:u.NOOP},onRemove:{type:(0,p.jq)(Function),default:u.NOOP},onStart:{type:(0,p.jq)(Function),default:u.NOOP},onSuccess:{type:(0,p.jq)(Function),default:u.NOOP},onProgress:{type:(0,p.jq)(Function),default:u.NOOP},onError:{type:(0,p.jq)(Function),default:u.NOOP},onExceed:{type:(0,p.jq)(Function),default:u.NOOP}});var U=o(91392);const T=(0,n.defineComponent)({name:"ElUploadContent",inheritAttrs:!1}),L=(0,n.defineComponent)({...T,props:$,setup(e,{expose:t}){const o=e,r=(0,B.DU)("upload"),a=(0,N.CB)(),l=(0,n.shallowRef)({}),s=(0,n.shallowRef)(),i=e=>{if(0===e.length)return;const{autoUpload:t,limit:n,fileList:r,multiple:a,onStart:l,onExceed:s}=o;if(n&&r.length+e.length>n)s(e,r);else{a||(e=e.slice(0,1));for(const o of e){const e=o;e.uid=h(),l(e),t&&c(e)}}},c=async e=>{if(s.value.value="",!o.beforeUpload)return d(e);let t,n={};try{const r=o.data,a=o.beforeUpload(e);n=(0,u.isPlainObject)(o.data)?(0,F.A)(o.data):o.data,t=await a,(0,u.isPlainObject)(o.data)&&(0,R.A)(r,n)&&(n=(0,F.A)(o.data))}catch(e){t=!1}if(!1===t)return void o.onRemove(e);let r=e;t instanceof Blob&&(r=t instanceof File?t:new File([t],e.name,{type:e.type})),d(Object.assign(r,{uid:e.uid}),n)},d=async(e,t)=>{const{headers:n,data:r,method:a,withCredentials:s,name:i,action:c,onProgress:d,onSuccess:f,onError:p,httpRequest:m}=o;try{t=await(async(e,t)=>(0,u.isFunction)(e)?e(t):e)(null!=t?t:r,e)}catch(t){return void o.onRemove(e)}const{uid:v}=e,y={headers:n||{},withCredentials:s,file:e,data:t,method:a,filename:i,action:c,onProgress:t=>{d(t,e)},onSuccess:t=>{f(t,e),delete l.value[v]},onError:t=>{p(t,e),delete l.value[v]}},h=m(y);l.value[v]=h,h instanceof Promise&&h.then(y.onSuccess,y.onError)},f=e=>{const t=e.target.files;t&&i(Array.from(t))},p=()=>{a.value||(s.value.value="",s.value.click())},m=()=>{p()};return t({abort:e=>{(0,U.Mc)(l.value).filter(e?([t])=>String(e.uid)===t:()=>!0).forEach((([e,t])=>{t instanceof XMLHttpRequest&&t.abort(),delete l.value[e]}))},upload:c}),(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)([(0,n.unref)(r).b(),(0,n.unref)(r).m(e.listType),(0,n.unref)(r).is("drag",e.drag),(0,n.unref)(r).is("disabled",(0,n.unref)(a))]),tabindex:(0,n.unref)(a)?"-1":"0",onClick:p,onKeydown:(0,n.withKeys)((0,n.withModifiers)(m,["self"]),["enter","space"])},[e.drag?((0,n.openBlock)(),(0,n.createBlock)(_,{key:0,disabled:(0,n.unref)(a),onFile:i},{default:(0,n.withCtx)((()=>[(0,n.renderSlot)(e.$slots,"default")])),_:3},8,["disabled"])):(0,n.renderSlot)(e.$slots,"default",{key:1}),(0,n.createElementVNode)("input",{ref_key:"inputRef",ref:s,class:(0,n.normalizeClass)((0,n.unref)(r).e("input")),name:e.name,disabled:(0,n.unref)(a),multiple:e.multiple,accept:e.accept,type:"file",onChange:f,onClick:(0,n.withModifiers)((()=>{}),["stop"])},null,42,["name","disabled","multiple","accept","onClick"])],42,["tabindex","onKeydown"]))}});var z=(0,b.A)(L,[["__file","upload-content.vue"]]),D=(o(20116),o(61701),o(14603),o(47566),o(98721),o(91737));const A="ElUpload",M=e=>{var t;(null==(t=e.url)?void 0:t.startsWith("blob:"))&&URL.revokeObjectURL(e.url)},H=(e,t)=>{const o=(0,D.hRP)(e,"fileList",void 0,{passive:!0}),r=e=>o.value.find((t=>t.uid===e.uid));function a(e){var o;null==(o=t.value)||o.abort(e)}function l(e){o.value=o.value.filter((t=>t.uid!==e.uid))}return(0,n.watch)((()=>e.listType),(t=>{"picture-card"!==t&&"picture"!==t||(o.value=o.value.map((t=>{const{raw:n,url:r}=t;if(!r&&n)try{t.url=URL.createObjectURL(n)}catch(n){e.onError(n,t,o.value)}return t})))})),(0,n.watch)(o,(e=>{for(const t of e)t.uid||(t.uid=h()),t.status||(t.status="success")}),{immediate:!0,deep:!0}),{uploadFiles:o,abort:a,clearFiles:function(e=["ready","uploading","success","fail"]){o.value=o.value.filter((t=>!e.includes(t.status)))},handleError:(t,n)=>{const a=r(n);a&&(console.error(t),a.status="fail",l(a),e.onError(t,a,o.value),e.onChange(a,o.value))},handleProgress:(t,n)=>{const a=r(n);a&&(e.onProgress(t,a,o.value),a.status="uploading",a.percentage=Math.round(t.percent))},handleStart:t=>{(0,i.A)(t.uid)&&(t.uid=h());const n={name:t.name,percentage:0,status:"ready",size:t.size,raw:t,uid:t.uid};if("picture-card"===e.listType||"picture"===e.listType)try{n.url=URL.createObjectURL(t)}catch(t){(0,c.U)(A,t.message),e.onError(t,n,o.value)}o.value=[...o.value,n],e.onChange(n,o.value)},handleSuccess:(t,n)=>{const a=r(n);a&&(a.status="success",a.response=t,e.onSuccess(t,a,o.value),e.onChange(a,o.value))},handleRemove:async t=>{const n=t instanceof File?r(t):t;n||(0,c.$)(A,"file to be removed not found");const s=t=>{a(t),l(t),e.onRemove(t,o.value),M(t)};if(e.beforeRemove){!1!==await e.beforeRemove(n,o.value)&&s(n)}else s(n)},submit:function(){o.value.filter((({status:e})=>"ready"===e)).forEach((({raw:e})=>{var o;return e&&(null==(o=t.value)?void 0:o.upload(e))}))},revokeFileObjectURL:M}},K=(0,n.defineComponent)({name:"ElUpload"}),X=(0,n.defineComponent)({...K,props:k,setup(e,{expose:t}){const o=e,a=(0,N.CB)(),l=(0,n.shallowRef)(),{abort:s,submit:i,clearFiles:c,uploadFiles:u,handleStart:d,handleError:f,handleRemove:p,handleSuccess:m,handleProgress:v,revokeFileObjectURL:y}=H(o,l),h=(0,n.computed)((()=>"picture-card"===o.listType)),g=(0,n.computed)((()=>({...o,fileList:u.value,onStart:d,onProgress:v,onSuccess:m,onError:f,onRemove:p})));return(0,n.onBeforeUnmount)((()=>{u.value.forEach(y)})),(0,n.provide)(r,{accept:(0,n.toRef)(o,"accept")}),t({abort:s,submit:i,clearFiles:c,handleStart:d,handleRemove:p}),(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",null,[(0,n.unref)(h)&&e.showFileList?((0,n.openBlock)(),(0,n.createBlock)(S,{key:0,disabled:(0,n.unref)(a),"list-type":e.listType,files:(0,n.unref)(u),crossorigin:e.crossorigin,"handle-preview":e.onPreview,onRemove:(0,n.unref)(p)},(0,n.createSlots)({append:(0,n.withCtx)((()=>[(0,n.createVNode)(z,(0,n.mergeProps)({ref_key:"uploadRef",ref:l},(0,n.unref)(g)),{default:(0,n.withCtx)((()=>[e.$slots.trigger?(0,n.renderSlot)(e.$slots,"trigger",{key:0}):(0,n.createCommentVNode)("v-if",!0),!e.$slots.trigger&&e.$slots.default?(0,n.renderSlot)(e.$slots,"default",{key:1}):(0,n.createCommentVNode)("v-if",!0)])),_:3},16)])),_:2},[e.$slots.file?{name:"default",fn:(0,n.withCtx)((({file:t,index:o})=>[(0,n.renderSlot)(e.$slots,"file",{file:t,index:o})]))}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):(0,n.createCommentVNode)("v-if",!0),!(0,n.unref)(h)||(0,n.unref)(h)&&!e.showFileList?((0,n.openBlock)(),(0,n.createBlock)(z,(0,n.mergeProps)({key:1,ref_key:"uploadRef",ref:l},(0,n.unref)(g)),{default:(0,n.withCtx)((()=>[e.$slots.trigger?(0,n.renderSlot)(e.$slots,"trigger",{key:0}):(0,n.createCommentVNode)("v-if",!0),!e.$slots.trigger&&e.$slots.default?(0,n.renderSlot)(e.$slots,"default",{key:1}):(0,n.createCommentVNode)("v-if",!0)])),_:3},16)):(0,n.createCommentVNode)("v-if",!0),e.$slots.trigger?(0,n.renderSlot)(e.$slots,"default",{key:2}):(0,n.createCommentVNode)("v-if",!0),(0,n.renderSlot)(e.$slots,"tip"),!(0,n.unref)(h)&&e.showFileList?((0,n.openBlock)(),(0,n.createBlock)(S,{key:3,disabled:(0,n.unref)(a),"list-type":e.listType,files:(0,n.unref)(u),crossorigin:e.crossorigin,"handle-preview":e.onPreview,onRemove:(0,n.unref)(p)},(0,n.createSlots)({_:2},[e.$slots.file?{name:"default",fn:(0,n.withCtx)((({file:t,index:o})=>[(0,n.renderSlot)(e.$slots,"file",{file:t,index:o})]))}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):(0,n.createCommentVNode)("v-if",!0)]))}});var G=(0,b.A)(X,[["__file","upload.vue"]]);const J=(0,o(25376).GU)(G)}}]);